{"remainingRequest":"/Users/kiyoungtack/Desktop/boiler/node_modules/babel-loader/lib/index.js??ruleSet[1].rules[0].use[1]!/Users/kiyoungtack/Desktop/boiler/src/controllers/commentController.ts","dependencies":[{"path":"/Users/kiyoungtack/Desktop/boiler/src/controllers/commentController.ts","mtime":1611422866059},{"path":"/Users/kiyoungtack/Desktop/boiler/.babelrc","mtime":1610697389559},{"path":"/Users/kiyoungtack/Desktop/boiler/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/kiyoungtack/Desktop/boiler/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IGRiIGZyb20gJ2RiJzsKCmNvbnN0IGNyZWF0ZSA9IGFzeW5jIGN0eCA9PiB7CiAgY29uc3QgewogICAgdGV4dCwKICAgIHBvc3QKICB9ID0gY3R4LnJlcXVlc3QuYm9keTsKICBjb25zdCBhdXRob3IgPSBhd2FpdCBkYi51c2Vycy5maW5kT25lKHsKICAgIF9pZDogY3R4LnN0YXRlLnVzZXIuX2lkCiAgfSk7CiAgY29uc3QgZXhwdXAgPSBhd2FpdCBkYi51c2Vycy5maW5kT25lQW5kVXBkYXRlKHsKICAgIF9pZDogYXV0aG9yLl9pZAogIH0sIHsKICAgICRpbmM6IHsKICAgICAgZXhwOiArMQogICAgfQogIH0pOwogIGV4cHVwPy5zYXZlKCk7CiAgY29uc3QgY29tbWVudCA9IGF3YWl0IGRiLmNvbW1lbnRzLmNyZWF0ZSh7CiAgICB0ZXh0LAogICAgYXV0aG9yOiBhdXRob3IubmFtZSwKICAgIGF1dGhvcmV4cDogYXV0aG9yLmV4cCwKICAgIHBvc3QKICB9KTsKCiAgdHJ5IHsKICAgIGNvbnN0IGNtdHB1c2ggPSBhd2FpdCBkYi5wb3N0cy5maW5kT25lKHsKICAgICAgX2lkOiBwb3N0CiAgICB9KTsKICAgIGF3YWl0IGNtdHB1c2guY29tbWVudHMucHVzaChjb21tZW50Ll9pZCk7CiAgICBjbXRwdXNoPy5zYXZlKCk7CiAgfSBjYXRjaCAoZXJyKSB7fQoKICB0cnkgewogICAgY29uc3QgY210cHVzaCA9IGF3YWl0IGRiLmpvYnMuZmluZE9uZSh7CiAgICAgIF9pZDogcG9zdAogICAgfSk7CiAgICBhd2FpdCBjbXRwdXNoLmNvbW1lbnRzLnB1c2goY29tbWVudC5faWQpOwogICAgY210cHVzaD8uc2F2ZSgpOwogIH0gY2F0Y2ggKGVycikge30KCiAgdHJ5IHsKICAgIGNvbnN0IGNtdHB1c2ggPSBhd2FpdCBkYi5tYXJrZXRzLmZpbmRPbmUoewogICAgICBfaWQ6IHBvc3QKICAgIH0pOwogICAgYXdhaXQgY210cHVzaC5jb21tZW50cy5wdXNoKGNvbW1lbnQuX2lkKTsKICAgIGNtdHB1c2g/LnNhdmUoKTsKICB9IGNhdGNoIChlcnIpIHt9CgogIGN0eC5zdGF0dXMgPSAyMDA7Cn07Cgpjb25zdCB1cGRhdGUgPSBhc3luYyBjdHggPT4gewogIGNvbnN0IGlkID0gY3R4LnBhcmFtcy5pZDsKICBjb25zdCB7CiAgICB0ZXh0CiAgfSA9IGN0eC5yZXF1ZXN0LmJvZHk7CiAgY29uc3QgdXAgPSBhd2FpdCBkYi5jb21tZW50cy5maW5kT25lQW5kVXBkYXRlKHsKICAgIF9pZDogaWQKICB9LCB7CiAgICB0ZXh0CiAgfSk7CiAgY3R4LnN0YXR1cyA9IDIwMDsKfTsKCmNvbnN0IGRlbGV0ZW9uZSA9IGFzeW5jIGN0eCA9PiB7CiAgY29uc3QgaWQgPSBjdHgucGFyYW1zLmlkOwogIGNvbnN0IGRlbCA9IGF3YWl0IGRiLmNvbW1lbnRzLmZpbmRPbmVBbmREZWxldGUoewogICAgX2lkOiBpZAogIH0pOwogIGN0eC5zdGF0dXMgPSAyMDA7Cn07CgpleHBvcnQgZGVmYXVsdCB7CiAgY3JlYXRlLAogIGRlbGV0ZW9uZSwKICB1cGRhdGUKfTs="},{"version":3,"sources":["/Users/kiyoungtack/Desktop/boiler/src/controllers/commentController.ts"],"names":["db","create","ctx","text","post","request","body","author","users","findOne","_id","state","user","expup","findOneAndUpdate","$inc","exp","save","comment","comments","name","authorexp","cmtpush","posts","push","err","jobs","markets","status","update","id","params","up","deleteone","del","findOneAndDelete"],"mappings":"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","sourcesContent":["import db from 'db';\nimport {\n  createNoSubstitutionTemplateLiteral,\n  isNamedExportBindings,\n} from 'typescript';\nimport { Controller } from './types';\n\nconst create: Controller = async (ctx) => {\n  const { text, post } = ctx.request.body;\n  const author: any = await db.users.findOne({ _id: ctx.state.user._id });\n  const expup = await db.users.findOneAndUpdate(\n    { _id: author._id },\n    { $inc: { exp: +1 } }\n  );\n  expup?.save();\n  const comment = await db.comments.create({\n    text,\n    author: author.name,\n    authorexp: author.exp,\n    post,\n  });\n  try {\n    const cmtpush = await db.posts.findOne({ _id: post });\n    await (cmtpush as any).comments.push(comment._id);\n    cmtpush?.save();\n  } catch (err) {}\n  try {\n    const cmtpush = await db.jobs.findOne({ _id: post });\n    await (cmtpush as any).comments.push(comment._id);\n    cmtpush?.save();\n  } catch (err) {}\n  try {\n    const cmtpush = await db.markets.findOne({ _id: post });\n    await (cmtpush as any).comments.push(comment._id);\n    cmtpush?.save();\n  } catch (err) {}\n  ctx.status = 200;\n};\n\nconst update: Controller = async (ctx) => {\n  const id = ctx.params.id;\n  const { text } = ctx.request.body;\n  const up = await db.comments.findOneAndUpdate(\n    { _id: id },\n    {\n      text,\n    }\n  );\n  ctx.status = 200;\n};\n\nconst deleteone: Controller = async (ctx) => {\n  const id = ctx.params.id;\n  const del = await db.comments.findOneAndDelete({\n    _id: id,\n  });\n  ctx.status = 200;\n};\n\nexport default { create, deleteone, update };\n"]}]}